# Implementation Plan

## Tasks

- [x] 1. プロジェクト初期セットアップ
- [x] 1.1 Vite + React + TypeScriptプロジェクトを作成する
  - Vite 5でReact + TypeScriptテンプレートを使用してプロジェクトを初期化
  - 不要なボイラープレートファイルを削除
  - CSS Modulesの設定を確認
  - 開発サーバーが正常に起動することを確認
  - _Requirements: 4.4_

- [x] 1.2 (P) 基本的な型定義とデータモデルを作成する
  - セリフデータの型（キャラクター名とテキスト）を定義
  - ファイル単位のセリフコレクション型を定義
  - 解析結果の成功・失敗を表す型を定義
  - ファイル読み込み結果の型を定義
  - _Requirements: 3.1_

- [x] 2. JSON解析機能の実装
- [x] 2.1 JSONテキストをセリフデータに変換する機能を実装する
  - JSONテキストを受け取りセリフ配列を返す関数を作成
  - キャラクター名とテキストのペアを抽出
  - キャラクター名が欠落している場合は「不明」を設定
  - テキストが欠落しているオブジェクトはスキップ
  - _Requirements: 3.1, 3.2, 3.3_

- [x] 2.2 JSON解析のエラーハンドリングを実装する
  - 不正なJSON構文を検出してエラーメッセージを返す
  - 空の配列を検出して適切な結果を返す
  - 配列以外のデータ構造を検出してエラーを返す
  - _Requirements: 1.5, 3.4_

- [x] 3. ファイル入力機能の実装
- [x] 3.1 ファイル選択ダイアログによる入力を実装する
  - ファイル選択ボタンをUIに配置
  - 複数ファイル選択を有効化
  - 選択されたファイルを読み込みJSON解析を実行
  - JSONファイル以外が選択された場合はエラーメッセージを表示
  - _Requirements: 1.1, 1.2, 1.4, 4.1_

- [x] 3.2 ドラッグ&ドロップによるファイル入力を実装する
  - ドロップエリアをUIに配置
  - ドラッグオーバー時の視覚的フィードバックを追加
  - ドロップされたファイルを読み込みJSON解析を実行
  - 複数ファイルのドロップに対応
  - _Requirements: 1.3, 4.1_

- [x] 3.3 ファイル読み込みエラーの表示を実装する
  - 読み込みに失敗したファイル名とエラー内容を表示
  - 複数ファイル読み込み時は成功したファイルを表示しつつエラーも通知
  - エラーメッセージをユーザーが閉じられるようにする
  - _Requirements: 1.4, 1.5_

- [x] 4. セリフ表示機能の実装
- [x] 4.1 (P) 個別セリフの表示コンポーネントを実装する
  - キャラクター名とセリフテキストを表示
  - キャラクター名とセリフを視覚的に区別できるスタイルを適用
  - 読みやすいレイアウトで配置
  - _Requirements: 2.2, 4.2, 4.3_

- [x] 4.2 (P) ファイル別セクション表示を実装する
  - ファイル名を見出しとして表示
  - 該当ファイルのセリフを時系列順に表示
  - セクション間の視覚的な区切りを追加
  - _Requirements: 2.5, 2.6_

- [x] 4.3 セリフ一覧表示を実装する
  - 読み込んだすべてのファイルをファイル別セクションで表示
  - 複数ファイルを読み込み順に連結して表示
  - スクロールで全セリフを閲覧可能にする
  - セリフがない場合は「セリフがありません」と表示
  - _Requirements: 2.1, 2.3, 2.4, 3.4_

- [x] 5. キャラクターフィルター機能の実装
- [x] 5.1 キャラクター一覧の抽出と表示を実装する
  - 読み込んだファイルから登場キャラクターを重複なく抽出
  - キャラクター一覧をフィルターUIに表示
  - キャラクターをアルファベット順または登場順でソート
  - _Requirements: 5.1_

- [x] 5.2 キャラクター選択によるフィルタリングを実装する
  - キャラクターの選択・解除を可能にする
  - 選択されたキャラクターのセリフのみを表示
  - 複数キャラクターの同時選択に対応
  - フィルター未選択時はすべてのセリフを表示
  - _Requirements: 5.2, 5.3, 5.4_

- [x] 5.3 フィルター状態の視覚的表示を実装する
  - 選択中のキャラクターを視覚的に強調
  - フィルター適用中であることを示すインジケーター
  - フィルターをクリアするボタンを配置
  - _Requirements: 5.5_

- [x] 6. 統合とアプリケーション完成
- [x] 6.1 アプリケーション全体のレイアウトを構成する
  - ファイル入力エリア、フィルターパネル、セリフ一覧を配置
  - レスポンシブな配置でモダンブラウザに対応
  - 各コンポーネント間の状態連携を実装
  - _Requirements: 4.1, 4.2, 4.4_

- [x] 6.2 エンドツーエンドの動作確認を行う
  - ファイル選択からセリフ表示までの一連フローを確認
  - ドラッグ&ドロップからセリフ表示までの一連フローを確認
  - キャラクターフィルターの動作を確認
  - 複数ファイル読み込み時の動作を確認
  - エラー発生時の動作を確認
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 5.2_

## Requirements Coverage

| Requirement | Tasks |
|-------------|-------|
| 1.1 | 3.1, 6.2 |
| 1.2 | 3.1, 6.2 |
| 1.3 | 3.2, 6.2 |
| 1.4 | 3.1, 3.3 |
| 1.5 | 2.2, 3.3 |
| 2.1 | 4.3, 6.2 |
| 2.2 | 4.1 |
| 2.3 | 4.3 |
| 2.4 | 4.3 |
| 2.5 | 4.2 |
| 2.6 | 4.2 |
| 3.1 | 1.2, 2.1 |
| 3.2 | 2.1 |
| 3.3 | 2.1 |
| 3.4 | 2.2, 4.3 |
| 4.1 | 3.1, 3.2, 6.1 |
| 4.2 | 4.1, 6.1 |
| 4.3 | 4.1 |
| 4.4 | 1.1, 6.1 |
| 5.1 | 5.1 |
| 5.2 | 5.2, 6.2 |
| 5.3 | 5.2 |
| 5.4 | 5.2 |
| 5.5 | 5.3 |
